[
{
	"uri": "/vi/",
	"title": "Cơ bản về VPC Networking trên AWS ",
	"tags": [],
	"description": "",
	"content": "Làm việc với Amazon VPC Tổng quan Trong bài lab này, bạn sẽ tìm hiểu các khái niệm cơ bản và thực hành về Amazon VPC ( Virtual Private Networking ). Tìm hiểu các khái niệm chính, các tính năng trong Amazon VPC. Thực hành tạo VPC cơ bản và thực hiện cấu hình Site to Site VPN để kết nối môi trường on-premise tới môi trường VPC của AWS.\nNội dung  Giới thiệu VPC Tường lửa trong VPC Tạo VPC Cơ bản  "
},
{
	"uri": "/vi/1-vpc-introduction/",
	"title": "Giới thiệu Amazon VPC",
	"tags": [],
	"description": "",
	"content": "Amazon Virtual Private Cloud (Amazon VPC) dịch theo nghĩa đen là “Đám mây Riêng tư Ảo” là một mạng ảo tùy chỉnh nằm bên trong AWS Cloud và tách biệt (hoặc cô lập) mạng Ảo của riêng bạn với toàn bộ thế giới bên ngoài. Khái niệm này tương tự như việc thiết kế và triển khai một mạng độc lập riêng biệt mà hoạt động trong một trung tâm dữ liệu on-premise, loại hình vẫn còn rất phổ biến hiện nay tại Việt Nam.\nBên trong VPC tùy chỉnh đó, bạn có toàn quyền kiểm kiểm soát môi trường mạng ảo của mình, nghĩa là vừa có khả năng khởi tạo và chạy các tài nguyên AWS, vừa có thể lựa chọn phạm vi địa chỉ IP, tạo các mạng con và cấu hình các bảng định tuyến và cổng kết nối mạng. Bạn có thể sử dụng cả IPv4 và IPv6 để truy cập an toàn và dễ dàng vào tài nguyên và ứng dụng trong VPC.\nRegion là khái niệm mô tả một trung tâm dữ liệu cực lớn của AWS đặt tại một vùng lãnh thổ nhất định. Trong một region, ta có thể tạo ra nhiều VPC và mỗi VPC được phân biệt nhau bởi những dải không gian địa chỉ IP khác nhau. Ta chỉ định phạm vi địa chỉ IPv4 bằng cách lựa chọn a Classless Inter-Domain Routing (CIDR), chẳng hạn như 10.0.0.0/16. Phạm vi địa chỉ của Amazon VPC không thể thay đổi sau khi nó đã được tạo. Phạm vi địa chỉ Amazon VPC có thể lớn bằng /16 (tức 65536 địa chỉ khả dụng) hoặc nhỏ bằng /28 (tức 16 địa chỉ khả dụng) và chúng không được phép trùng với bất kỳ mạng nào khác mà chúng sẽ được kết nối tới.\nDịch vụ Amazon VPC được ra mắt sau dịch vụ Amazon EC2, vì vậy mà có thời điểm AWS cung cấp hai nền tảng mạng khác nhau đó là EC2-Classic và EC2-VPC. EC2-Classic là nền tảng mạng đầu tiên, trong đó tất cả Amazon EC2 được tạo ra đều nằm trong một mạng phẳng duy nhất, chia sẻ kết nối giữa các khách hàng của AWS. Cho tới tháng 12 năm 2013, AWS chỉ còn hỗ trợ EC2-VPC với VPC mặc định được tạo ra ở mỗi Region cùng một subnet mặc định với CIDR block có giá trị là 172.31.0.0/16.\nAmazon VPC bao gồm các thành phần cơ bản:\n Subnets Route tables Internet Gateways (IGWs) NAT gateways  Bây giờ chúng ta sẽ cùng nhau đi qua các khái niệm cơ bản nhất của VPC nhé.\nSubnets Subnet là một phân đoạn của dải địa chỉ IP mà bạn sử dụng khi khởi tạo Amazon VPC, cung cấp trực tiếp dải mạng hoạt động cho các tài nguyên AWS có thể chạy bên trong nó như Amazon EC2, Amazon RDS (CSDL Quan hệ Amazon),\u0026hellip; Các subnet cũng được xác định thông qua CIDR block (ví dụ: 10.0.1.0/24 và 192.168.0.0/24) và bắt buộc các CIDR của subnet phải nằm trong CIDR của VPC. Subnet nhỏ nhất có thể tạo được là /28 (16 địa chỉ IP). AWS lưu trữ 4 địa chỉ IP đầu tiên và 1 địa chỉ IP cuối cùng của mỗi subnet cho các mục đích kết nối mạng nội bộ. Ví dụ: subnet /28 có 16 địa chỉ IP khả dụng, nhưng loại bỏ 5 reserved IP cho AWS, như vậy còn lại 11 địa chỉ IP có thể sử dụng cho các tài nguyên hoạt động bên trong subnet này.\nAvailability Zone hay được viết tắt thành AZ là một trung tâm dữ liệu con, nằm bên trong Region và được xác định dựa treo vị trí địa lý. Bên trong AZ có thể có một hoặc nhiều subnet, nhưng một subnet chỉ có thể nằm trong duy nhất một AZ mà không thể mở rộng sang AZ khác.\nCác subnet được chia thành các loại như Public, Private, hoặc VPN-only.\n Public subnet là subnet có route table (sẽ thảo luận sau) điều hướng lưu lượng truy cập bên trong subnet đi tới VPC IGW (cũng sẽ thảo luận sau) Private subnet thì ngược lại với Public subnet, nó không có route table điều hướng lưu lượng truy cập tới VPC IGW. VPN-only subnet là subnet mà có route table điều hướng lưu lượng truy cập tới VPG của Amazon VPC (sẽ thảo luận sau).  Bất kể loại mạng con nào, dải địa chỉ IP nội bộ của subnet luôn là private (nghĩa là từ bên ngoài Internet không thể kết nối trực tiếp tới các địa chỉ thuộc dải này).\nRoute Table Route Table hay còn gọi là bảng định tuyến, cung cấp hướng dẫn định tuyến và được gán vào các Subnets. Ví dụ khi bạn tạo VPC với lớp mạng 10.10.0.0/16, cùng 2 subnet 10.10.1.0/24,10.10.2.0/24 thì mỗi subnets mặc định sẽ được gán 1 default route table.\nBên trong route table sẽ có route entry destination:10.10.0.0/16 target:local. Route entry này thể hiện các tài nguyên tạo ra trong cùng 1 VPC có thể kết nối với nhau.\nInternet Gateway Internet Gateway (IGW) là một thành phần Amazon VPC giúp các tài nguyên bên trong VPC, cụ thể là EC2, có khả năng giao tiếp với Internet. IGW có khả năng co giãn mạnh theo chiều ngang, đồng thời tính dự phòng và sẵn sàng cao. Nó hoạt động như một target trong bảng định tuyến của Amazon VPC, giúp lưu lượng truy cập được định tuyến ra ngoài Internet bằng cách biên dịch địa chỉ mạng của EC2 thành địa chỉ Public IP đã được gán cho nó.\nCụ thể hơn, các EC2 Instance bên trong VPC chỉ biết các địa chỉ Private IP được gán cho nó, nhưng khi có lưu lượng được gửi từ EC2 ra ngoài Internet, IGW sẽ biên dịch địa chỉ Private IP đó thành địa chỉ Public IP (hoặc địa chỉ EIP, sẽ thảo luận sau) mà gán với EC2, và duy trì mapping 1-1 cho tới khi địa chỉ Public IP bị release. Khi EC2 nhận được lưu lượng truy cập từ bên ngoài Internet, IGW sẽ thực hiện dịch địa chỉ Target (địa chỉ Public IP) thành địa chỉ Private IP của EC2 Instance và chuyển tiếp lưu lượng truy cập đến Amazon VPC.\nNAT Gateway Mặc định, mọi EC2 chạy bên trong Private subnet thì sẽ không có khả năng giao tiếp với Internet thông qua IGW. Từ đó vấn đề phát sinh khi EC2 đó cần truy cập ra ngoài Internet để áp dụng các bản cập nhật bảo mật, tải xuống các bản vá hoặc cập nhật phần mềm ứng dụng.\nNắm bắt được nhu cầu đó, AWS cung cấp 2 phương thức cho phép các EC2 bên trong Private subnet có quyền được truy cập Internet, đó là NAT Instance và NAT Gateway. Với các trường hợp thông thường, thì ta nên sử dụng NAT Gateway thay cho NAT Instance. NAT Gateway đảm bảo tính sẵn sàng và băng thông cao hơn, đồng thời đòi hỏi ít nỗ lực quản trị hơn so với NAT Instance.\nĐể tạo một một NAT gateway, ta phải chỉ định một mạng con (public) và một địa chỉ Elastic IP. Cần đảm bảo địa chỉ Elastic IP đang không được liên kết với bất cứ Instance hoặc một Network interface nào khác.\nTrường hợp ta muốn migrate từ NAT instance sang NAT gateway, ta có thể sử dụng lại địa chỉ Elastic IP của NAT instance. Nhưng trước hết ta cần phải tách địa chỉ IP ra khỏi NAT Instance.\n"
},
{
	"uri": "/vi/4-vpn-sitetosite/4.2-config-vpn/4.2.1-create-vgw/",
	"title": "Tao Virtual Private GW",
	"tags": [],
	"description": "",
	"content": " Truy cập trang Amazon VPC console tại địa chỉ https://console.aws.amazon.com/vpc/.   Kéo xuống phía dưới thanh điều hướng bên phải. Click Virtual Private Gateway. Click Create Virtual Private Gateway.   Tại trang Create Virtual Private Gateway:   Điền thông tin Name tag: VPN Gateway Click Create Virtual Private Gateway  Click Close.  Trong danh sách các Virtual Private Gateway, chọn vào VPN Gateway vừa tạo.   Chọn Actions \u0026gt; Attach to VPC. Chọn VPC ASG. Click Yes, Attach.   Lưu ý: theo như mô hình kiến trúc, Virtual Private Gateway sẽ nằm ở VPC trên môi trường AWS. Hiện tại chúng ta đang dùng VPC ASG để đóng vai trò môi trường AWS và VPC ASG VPN để giả lập môi trường on-premise.(Trung tâm dữ liệu truyền thống )\n\r"
},
{
	"uri": "/vi/4-vpn-sitetosite/4.1-deploy-infra/4.1.1-create-asg-vpn-vpc/",
	"title": "Tạo ASG VPN VPC",
	"tags": [],
	"description": "",
	"content": "Tạo ASG VPN VPC  Truy cập Amazon VPC console tại địa chỉ https://console.aws.amazon.com/vpc/ Trong navigation pane, Chọn Your VPCs, Create VPC.   Name tag điền tên VPC: ASG VPN IPv4 CIDR block điền dãy IP block của VPC : 10.11.0.0/16 Click Create VPC.   Phần cấu hình Tennacy chúng ta sẽ để ở cơ chế mặc định. Nếu chúng ta chuyển sang Dedicated sẽ có một số EC2 Instance type không phù hợp và sẽ không tạo được trong VPC với tennacy mode là Dedicated\n\rTrên thanh điều hướng bên trái, chọn Subnets. Chọn Create Subnet.   Lựa chọn VPC có tên là ASG VPN chúng ta vừa tạo. Name tag điền tên subnet: VPN Public Lựa chọn Availability Zone: ap-southeast-1a Chọn IPv4 CIDR block là 10.11.1.0/24 theo kiến trúc mô tả.  Kéo màn hình xuống dưới, click Create subnet để tiến hành tạo VPN Public với CIDR là 10.11.1.0/24 nằm trong Availability Zone ap-southeast-1a.  Làm tương tự để tạo thêm 1 subnet nữa bao gồm :   VPN Private với CIDR là 10.11.2.0/24 nằm trong Availability Zone ap-southeast-1b.   Trong giao diện quản lý subnet.   Click chọn VPN Public. Click action. Click chọn Modify auto-assign IP settings.  Click Enable auto-assign public IPv4 address và Click Save.  Tạo một Internet Gateway cho ASG VPC VPN  Truy cập Amazon VPC console. Trên thanh điều hướng bên trái, chọn Internet Gateways, Create Internet Gateways   Đặt tên cho Internet Gateway là Internet Gateway. Click Create Internet Gateway.  Tiếp theo chúng ta cần Attach Internet Gateway vào VPC ASG VPN.   Click Action. Click Attach to VPC. Click chọn VPC ASG VPN , VPC ID sẽ được tự động điền. Click Attach Internet Gateway.   Tiếp theo chúng ta cần tạo Route Table định tuyến đi ra ngoài internet thông qua Internet Gateway.   Trên thanh điều hướng bên trái, chọn Route Tables, Create Route Table  Điền tên Route Table trong phần Name tag: Route table VPN - Public.   Chọn VPC có tên ASG VPN , VPC id sẽ được tự động điền vào. Click Create.  Click Close.  Chọn Route table VPN - Public, click Action , click Edit routes.   Click Add route. Điền phần Destination CIDR : 0.0.0.0/0 đại diện cho Internet. Trong phần Target click chọn Internet Gateway, sau đó chọn Internet Gateway chúng ta đã tạo. Internet Gateway ID sẽ được tự động điền. Chọn Save routes  Đảm bảo Route table - Public đang được chọn.   Click vào tab Subnet Associations bên menu bên dưới. Click Edit subnet associations. Mở rộng cột Subnet ID bằng cách kéo thanh ngăn sang phải. Chọn subnet VPN Public. Click Save.    Như vậy chúng ta đã tiến hành:  Tạo Internet Gateway có tên Internet Gateway. Tạo Route table có tên Route table VPN - Public. Chỉnh sửa route trong route table Route table VPN - Public.  Thêm route entry Destination: 0.0.0.0/0 Target: Internet Gateway.   Associate Route table VPN - Public vào subnet VPN Public.    "
},
{
	"uri": "/vi/4-vpn-sitetosite/4.1-deploy-infra/",
	"title": "Tạo môi trường VPN",
	"tags": [],
	"description": "",
	"content": "Trước khi khởi tạo và cấu hình kết nối VPN Site to Site, chúng ta cần tạo môi trường giả lập chi nhánh (ASG VPN) như kiến trúc bên dưới.\nNội dung:\n Tạo ASG VPN VPC, 2 subnet, Internet Gateway Khởi tạo EC2 trên ASG VPN VPC  "
},
{
	"uri": "/vi/3-create-vpc/3.1-vpc-subnet/",
	"title": "Tạo VPC và Subnet",
	"tags": [],
	"description": "",
	"content": "Đầu tiên chúng ta sẽ tiến hành tạo VPC và 4 subnet, như kiến trúc dưới đây. Tạo một Amazon Virtual Private Cloud (VPC)  Truy cập Amazon VPC console tại địa chỉ https://console.aws.amazon.com/vpc/ Trong navigation pane, Chọn Your VPCs, Create VPC.   Name tag điền tên VPC: ASG IPv4 CIDR block điền dãy IP block của VPC : 10.10.0.0/16 Click Create VPC.  Phần cấu hình Tennacy chúng ta sẽ để ở cơ chế mặc định. Nếu chúng ta chuyển sang Dedicated sẽ có một số EC2 Instance type không phù hợp và sẽ không tạo được trong VPC với tennacy mode là Dedicated\n\rTạo các subnet   Truy cập Amazon VPC console.\n  Trên thanh điều hướng bên trái, chọn Subnets.\n  Chọn Create Subnet.   Lựa chọn VPC có tên là ASG chúng ta vừa tạo.\n  Name tag điền tên subnet: Public Subnet 1\n  Lựa chọn Availability Zone: ap-southeast-1a\n  Chọn IPv4 CIDR block là 10.10.1.0/24 theo kiến trúc mô tả.   Kéo màn hình xuống dưới, click Create subnet để tiến hành tạo Public subnet 1 với CIDR là 10.10.1.0/24 nằm trong Availability Zone ap-southeast-1a.\n  Làm tương tự để tạo thêm 3 subnet nữa bao gồm :\n Public subnet 2 với CIDR là 10.10.2.0/24 nằm trong Availability Zone ap-southeast-1b. Private subnet 1 với CIDR là 10.10.3.0/24 nằm trong Availability Zone ap-southeast-1a. Private subnet 2 với CIDR là 10.10.4.0/24 nằm trong Availability Zone ap-southeast-1b.     Bạn có thể thấy có 2 cột là Availability Zone và Availability Zone ID. Để tránh việc tài nguyên EC2 được sử dụng không đồng đều, (chúng ta thường có xu hướng dùng AZ a để chạy primary và AZ b để stand by chẳng hạn) nên AWS sẽ gán ngẫu nhiên Availability Zone vào Availability Zone ID. Chúng ta có thể hiểu rằng Availability Zone là 1 dạng alias , còn Availability Zone ID mới chính là yếu tố định danh. Ví dụ ở hình trên Availability Zone ap-southeast-1a được gán Availability Zone ID là\tapse1-az2. Ở một AWS account khác , Availability Zone ap-southeast-1a có thể có Availability Zone ID là apse1-az1.\n\rMột điểm đáng chú ý nữa là các subnet về cơ bản đều giống nhau, thông qua cấu hình route table và cấp phát public IP address mà chúng ta mới phân chia ra Public và Private Subnet.\n\rCho phép tự động cấp phát public ip address cho 2 public subnet.   Click chọn Public subnet 1.\n  Click action.\n  Click chọn Modify auto-assign IP settings.   Click Enable auto-assign public IPv4 address và Click Save.   Làm tương tự cho Public subnet 2.\n  "
},
{
	"uri": "/vi/4-vpn-sitetosite/4.2-config-vpn/",
	"title": "Cấu hình kết nối VPN",
	"tags": [],
	"description": "",
	"content": "Ở bước này chúng ta sẽ tiến hành tạo Virtual Private Gateway , Customer Gateway và kết nối VPN Site to Site.\nNội dung:\n Tạo Virtual Private Gateway Tạo Customer Gateway Tạo VPN Connection Cấu hình VPN Connection  "
},
{
	"uri": "/vi/4-vpn-sitetosite/4.2-config-vpn/4.2.2-create-cgw/",
	"title": "Tao Customer GW",
	"tags": [],
	"description": "",
	"content": " Truy cập trang Amazon VPC console tại địa chỉ https://console.aws.amazon.com/vpc/.   Kéo xuống phía dưới thanh điều hướng bên phải. Click Virtual Private Gateway. Click Create Virtual Private Gateway.   Tại trang Create Customer Gateway:   Điền thông tin Name : Customer Gateway Tại mục Routing bảo đảm cấu hình đang để mặc định là static. Tại mục IP Address điền public IP address của máy chủ EC2 Customer Gateway. Click Create Customer Gateway.  Click Close.  Lưu ý: theo như mô hình kiến trúc, Customer Gateway sẽ nằm ở VPC trên môi trường onpremise. Hiện tại chúng ta đang làm là khai báo với AWS rằng chúng ta sẽ có 1 Customer Gateway với địa chỉ IP public là địa chỉ public của EC2 instance : Customer Gateway nằm trong ASG VPN VPC.\n\r"
},
{
	"uri": "/vi/2-secure-feature/",
	"title": "Tường lửa trong VPC",
	"tags": [],
	"description": "",
	"content": "Trong phần này, chúng ta sẽ cùng tìm hiểu các tính năng bảo mật cơ bản trong Amazon VPC như tính năng tường lửa Security Group và Network Access Control Lists, tính năng theo dõi thông tin gói tin ra vào VPC Flow Logs nhé.\nMột security group hoạt động như một tường lửa ảo cho Instance, giúp kiểm soát lưu lượng truy cập. Một Instance trong VPC có thể được gán tối đa 5 Security group do SG chỉ hoạt động ở tầng Instance mà không họat động ở tầng Subnet.\nSecurity groups hoạt động ở mức máy ảo, không phải ở mức subnet. Tuy nhiên, mỗi máy ảo trong một subnet có thể được gán với nhiều bộ Security group khác nhau,\n\rDanh sách kiểm soát truy cập mạng (ACL) là lớp bảo mật tùy chọn cho VPC, nó hoạt động như một tường lửa để kiểm soát lưu lượng ra và vào cho một hoặc nhiều subnet. Ta có thể thiết lập network ACL với các rule tương tự như security groups, nhằm bổ sung thêm một lớp bảo mật nữa cho VPC.\nNội dung:\n Security groups Network ACLs  Security Group  Cơ bản về Security group Security group Rule Tạo một Security Group Thêm rule vào Security Group  Cơ bản về Security group Một số đặc điểm cơ bản của Security group:\n Chỉ có thể thêm vào các Allow rule, mà không thể bổ sung Deny rule. Có thể chỉ định các rule riêng biệt cho lưu lượng truy cập đi ra hoặc đi vào. Một Security group mới được tạo ra không có sẵn Inbound rules. Do đó, tại thời điểm ban đầu Instance sẽ không cho phép bất cứ lưu lượng truy cập nào được phép đi vào, đòi hỏi ta phải bổ sung Inbound rule để cấp phép truy cập. Mặc định, Security group có sẵn Outbound rule cho phép mọi lưu lượng được phép đi ra khỏi Instance. Rule này có thể được chỉnh sửa (xóa) và bổ sung các Outbound rule cụ thể, chỉ rõ lưu lượng nào xuất phát từ Instance được phép đi ra ngoài. Nếu SG không có Outbound rule thì không một lưu lượng nào được phép đi ra khởi Instance. Security groups là một dịch vụ Stateful - nghĩa là nếu lưu lượng đi vào Instance đã được cấp phép thì lưu lượng cũng có thể đi ra ngoài Instance, và ngược lại, bất kể Outbound rule như thế nào. Các Instance chỉ có thể giao tiếp được với nhau khi và chỉ khi chúng được liên kết với Security group cho phép kết nối, hoặc Security group mà Instance có liên kết chứa Rule cho phép lưu lượng try cập (ngoại trừ Security group mặc định với có các rule mặc định cho phép toàn bộ lưu lượng được truy cập). Security group được liên kết với các network interface. Sau khi Instance đã được khởi tạo, ta vẫn có thể thay đổi Security group đã được gán với Instance, điều này cũng thay đổi security group đang được gán với primary network interface tương ứng.  Security group Rule Rule được sinh ra để cấp quyền truy cập cho lưu lượng đi vào hoặc đi ra khỏi Instance. Quyền truy cập này có thể được áp dụng cho một CIDR cụ thể hoặc cho một Security group nằm trong cùng một VPC hoặc nằm trong một VPC khác nhưng có kết nối peering đã được khởi tạo.\nCác thành phần cơ bản của Security group rule:\n (Chỉ đối với Inbound rules) gồm điểm xuất phát (nguồn) của lưu lượng truy cập và port đích hoặc dải port. Nguồn có thể là một security group khác, là một dải IPv4 hoặc IPv6 CIDR hoặc đơn thuẩn là một địa chỉ IPv4 hoặc IPv6. (Chỉ đối với Outbound rules) gồm đích đến của lưu lượng và port đích hay dải port đích. Đích đến có thể là một security group khác, là một dải IPv4 hoặc IPv6 CIDR hoặc đơn thuẩn là một địa chỉ IPv4 hoặc IPv6 hoặc là một dịch vụ bắt đầu bằng một tiền tố (ví dụ: igw_xxx) nằm trong danh sách prefix ID(một dịch vụ được xác định bởi prefix ID - tên và ID của dịch vụ khả dụng trong region). Mọi giao thức đều có một số giao thức chuẩn. Ví dụ: SSH là 22,..  Network ACLs  Cơ bản về Network ACL Network ACL rules Khởi tạo một network ACL Bổ sung rules vào một network ACL  Cơ bản về Network ACL  VPC sau khi khởi tạo sẽ có sẵn một network ACL mặc định và có thể được sửa đổi. Mặc định, nó cấp phép truy cập cho tất cả lưu lượng truy cập IPv4 hoặc IPv6 có thể đi ra hoặc đi vào VPC. Có thể tạo một network ACL tùy chỉnh và liên kết nó với một subnet. Mặc định các network ACL tùy chỉnh từ chối tất cả lưu lượng truy cập đi vào và đi ra, cho đến khi ta bổ sung rule cấp phép truy cập. Từng subnet trong VPC phải được liên kết với một network ACL. Nếu subnet không được liên kết với một network ACL cụ thể thì subnet sẽ được tự động liên kết với network ACL mặc định. Một network ACL có thể liên kết với nhiều subnet. Tuy nhiên, một subnet chỉ có thể liên kết với một network ACL tại một thời điểm. Khi liên kết network ACL mới với subnet,thì liên kết trước đó sẽ bị xóa. Một network ACL chứa một danh sách các rule được đánh số khác nhau. AWS đánh giá các rule dựa trên số thứ tự được gán, bắt đầu với rule được đánh số thấp nhất, để xác định xem lưu lượng có được phép đi vào hay đi ra khỏi bất kỳ subnet nào được liên kết với network ACL hay không. Số thứ tự lớn nhất có thể được gán cho rule là 32766 (tương đương số lượng rule lớn nhất của một network ACL là 32766). Network ACL có các rule cấp phép đi vào hoặc đi ra tách biệt và rule có thể là cho phép hoặc từ chối lưu lượng. Network ACL là dịch vụ Stateless, nghĩa là phản hồi đối với lưu lượng truy cập được phép đi vào, phải tuân theo rule đối với lưu lượng truy cập đi ra (và ngược lại).  Network ACL rules Có thể thêm hoặc xóa một rule khỏi network ACL mặc định hoặc tạo network ACL mới cho VPC. Khi thêm hoặc xóa một rule khỏi network ACL, các thay đổi sẽ tự động được áp dụng cho các subnet được liên kết với nó.\nCác thành phần của một network ACL rule:\n Rule number. Rule bắt đầu được đánh giá bắt đầu với rule có số thứ tự thấp nhất. Ngay khi rule đó match với lưu lượng truy cập, nó sẽ ngay lập tức được áp dụng cho dù nó mâu thuẫn với một rule nào đó được đánh số lớn hơn trong danh sách. Type.loại lưu lượng, ví dụ SSH. Có thể chỉ định tất cả các loại lưu lượng truy cập hoặc phạm vi tùy chỉnh. Protocol. chỉ định giao thức cùng số giao thức chuẩn. Port range. port hoặc dải port lắng nghe của lưu lượng truy cập. Ví dụ: HTTP là 80. Source. [chỉ đối với Inbound rule] Xuất phát của lưu lượng truy cập (giá trị là dải CIDR). Destination. [chỉ đối với Outbound rule] Điểm đến của lưu lượng truy cập (giá trị là dải CIDR). Allow/Deny. chỉ rõ là Cho phép hoặc Từ chối lưu lượng truy cập.  "
},
{
	"uri": "/vi/4-vpn-sitetosite/4.1-deploy-infra/4.1.2-create-ec2/",
	"title": "Tạo 2 EC2 Instance",
	"tags": [],
	"description": "",
	"content": "Tạo 2 EC2 để làm Customer Gateway và EC2 Private 2  Tạo Security Group cho Customer Gateway   Truy cập Amazon VPC console. Trên thanh điều hướng bên trái, chọn Security Group, click Create Security Group.  Trong phần Security group name điền VPN Public - SG   Trong phần Description điền Allow IPSec, SSH and Ping for servers in public subnet. Click chọn VPC, lựa chọn VPC có tên ASG VPN.   Trong Inbound rules, click Add rule.   Chọn Type: SSH và Source: My IP. My IP đại diện cho 1 địa chỉ public IPv4 bạn đang sử dụng. Click Add rule để thêm 1 rule mới. Chọn Type: Custom ICMP v4 và Source: Anywhere. Cho phép ping từ bất kì địa chỉ IP nào. Click Add rule để thêm 1 rule mới. Chọn Type: Custom UDP , **Port:400 và Source : Anywhere. Click Add rule để thêm 1 rule mới. Chọn Type: Custom UDP , **Port:500 và Source : Anywhere.  Kéo màn hình xuống dưới và Click Create Security Group.  Tạo Security Group cho EC2 Private 2   Trên thanh điều hướng bên trái, chọn Security Group, click Create Security Group. Trong phần Security group name điền VPN Private - SG Trong phần Description điền Allow SSH and Ping for servers in private subnet. Click chọn VPC, lựa chọn VPC có tên ASG VPN.  Trong Inbound rules, click Add rule.   Chọn Type: SSH và để nguyên Source: Custom. Click vào search box và chọn VPN Public - SG.Lựa chọn này cho phép tất cả những máy chủ được gán VPN Public - SG được SSH vào các máy chủ được gán VPN Private - SG. Click Add rule để thêm 1 rule mới. Chọn Type: Custom ICMP v4 và Source: Anywhere. Cho phép ping từ bất kì địa chỉ IP nào.  Kiểm tra cấu hình của bạn và kéo màn hình xuống dưới và Click Create Security Group.   Như vậy chúng ta đã tạo được 2 Security Group cho các máy chủ nằm trong public subnet và private subnet. Tiếp theo chúng ta sẽ tiến hành tạo 2 máy chủ EC2 đóng vai trò Customer Gateway và EC2 Private 2\n  Truy cập Amazon EC2 console tại địa chỉ https://console.aws.amazon.com/ec2/.\n   Trên thanh điều hướng bên trái, chọn Intances, Launch Intance. Chọn Select để chọn Amazon Machine Image (AMI) Amazon Linux 2 AMI (HVM), SSD Volume Type.    Giữ nguyên lựa chọn General purpose t2.micro, sau đó click Next: Configure Instance Details.   Tại trang Configure Instance Details\n   Network chọn VPC ASG VPN. Subnet chọn subnet VPN Public. Auto-assign Public IP kiểm tra xem có đang Enable hay không. Nếu không Enable, bạn cần kiểm tra lại phần cấu hình tự động cấp phát public IP cho subnet. Sau đó click Next: Add Storage.   Tại trang Add Storage. Giữ nguyên cấu hình mặc định và Click Next: Add Tags Tại trang Add Tags, Chọn Add Tag   Key điền Name. Value điền Customer Gateway. Sau đó bấm Next: Configure Security Group.  Tại trang Configure Security Group   Assign a security group click chọn Select an existing security group. Name chọn security group cho các EC2 trong public cubnet có tên VPN Public - SG. Sau đó bấm Review và Launch.   Kiểm tra lại thông tin cấu hình và Click Launch.   Một prompt Choose an existing key pair or Create new key pair xuất hiện. Chọn Choose an existing keypair. Chọn Key pair name: asg-keypair. Click I acknowledge that I have access to the selected private key file (asg-keypair.pem), and that without this file, I won\u0026rsquo;t be able to log into my instance. để xác nhận rằng mình có thể truy cập tới Key pair bạn đã chọn. Click Launch.  Click View Instances và chờ cho tới khi EC2 khởi tạo xong.  Trong giao diện console EC2 , sau khi tạo xong instance Customer Gateway. Click Launch Intance.   Chọn Select để chọn Amazon Machine Image (AMI) Amazon Linux 2 AMI (HVM), SSD Volume Type. Giữ nguyên lựa chọn General purpose t2.micro, sau đó click Next: Configure Instance Details.  Tại trang Configure Instance Details   Network chọn VPC ASG VPN. Subnet chọn subnet VPN Private. Auto-assign Public IP kiểm tra xem có đang Disable hay không. Sau đó click Next: Add Storage.   Tại trang Add Storage. Giữ nguyên cấu hình mặc định và Click Next: Add Tags Tại trang Add Tags, Chọn Add Tag   Key điền Name. Value điền EC2 Private 2. Sau đó bấm Next: Configure Security Group.  Tại trang Configure Security Group   Assign a security group click chọn Select an existing security group. Name chọn security group cho các EC2 trong public cubnet có tên VPN Private - SG. Sau đó bấm Review và Launch.   Kiểm tra lại thông tin cấu hình và Click Launch.   Một prompt Choose an existing key pair or Create new key pair xuất hiện. Chọn Choose an existing keypair. Chọn Key pair name: asg-keypair. Click I acknowledge that I have access to the selected private key file (asg-keypair.pem), and that without this file, I won\u0026rsquo;t be able to log into my instance. để xác nhận rằng mình có thể truy cập tới Key pair bạn đã chọn. Click Launch. Click View Instances và chờ cho tới khi EC2 khởi tạo xong.  Như vậy chúng ta đã tạo được 2 máy chủ EC2 theo mô hình kiến trúc yêu cầu. Bước tiếp theo chúng ta sẽ bắt đầu khởi tạo và cấu hình kết nối VPN Site to Site.   "
},
{
	"uri": "/vi/3-create-vpc/3.2-internet-gateway/",
	"title": "Tạo IGW và Route table",
	"tags": [],
	"description": "",
	"content": "Sau khi tạo VPC và các subnet, bước tiếp theo chúng ta sẽ tạo Internet Gateway , tạo và cấu hình Route table. Sau khi hoàn tất các bước bên dưới, chúng ta sẽ có kiến trúc như sau: Tạo một Internet Gateway   Truy cập Amazon VPC console.\n  Trên thanh điều hướng bên trái, chọn Internet Gateways, Create Internet Gateways   Đặt tên cho Internet Gateway là Internet Gateway.\n  Click Create Internet Gateway.   Click Action.\n  Click Attach to VPC.   Click chọn VPC ASG , VPC ID sẽ được tự động điền.\n  Click Attach Internet Gateway.   Tạo Route Table định tuyến đi ra ngoài internet thông qua Internet Gateway.  Truy cập Amazon VPC console. Trên thanh điều hướng bên trái, chọn Route Tables, Create Route Table    Điền tên Route Table trong phần Name tag: Route table - Public.\n  Chọn VPC có tên ASG , VPC id sẽ được tự động điền vào.\n  Click Create.   Click Close.\n  Chọn **Route table - Public **, click Action , click Edit routes.   Click Add route.\n  Điền phần Destination CIDR : 0.0.0.0/0 đại diện cho Internet.\n  Trong phần Target click chọn Internet Gateway, sau đó chọn Internet Gateway chúng ta đã tạo. Internet Gateway ID sẽ được tự động điền.\n  Chọn Save routes   Đảm bảo Route table - Public đang được chọn.\n  Click vào tab Subnet Associations bên menu bên dưới.\n  Click Edit subnet associations.   Mở rộng cột Subnet ID bằng cách kéo thanh ngăn sang phải.\n  Chọn đúng 2 subnet public chúng ta đã tạo.\n  Click Save.   Như vậy chúng ta đã tiến hành:\n Tạo Internet Gateway có tên Internet Gateway. Tạo Route table có tên Route table - Public Chỉnh sửa route trong route table Route table - Public.  Thêm route entry Destination: 0.0.0.0/0 Target: Internet Gateway.   Associate Route table - Public vào 2 subnet Public subnet 1 và Public subnet 2.    "
},
{
	"uri": "/vi/3-create-vpc/",
	"title": "Thực hành tạo 1 VPC",
	"tags": [],
	"description": "",
	"content": "Xuyên suốt bài thực hành này, chúng ta sẽ xây dựng một mô hình theo sơ đồ bên dưới:\nNội dung:\n Tạo VPC và subnets  Tạo một Internet gateway và Route Table Tạo Security group cho các VM nằm trong Public \u0026amp; Private subnet Tạo máy chủ EC2 Kiểm tra kết nối Tạo NAT Gateway và ping ra ngoài internet từ EC2 Private  "
},
{
	"uri": "/vi/4-vpn-sitetosite/4.2-config-vpn/4.2.3-create-vpn-connection/",
	"title": "Tạo kết nối VPN",
	"tags": [],
	"description": "",
	"content": " Truy cập trang Amazon VPC console tại địa chỉ https://console.aws.amazon.com/vpc/   Kéo thanh điều hướng xuống dưới. Click Site-to-Site VPN Connections. Click Create VPN Connection.   Tại trang Create VPN Connection điền thông tin:   Name tag: VPN Connection Target Gateway Type: Chọn Virtual Private Gateway Virtual Private Gateway: Chọn VPN Gateway Customer Gateway: Existing Customer Gateway ID:\tChọn Customer Gateway Routing Options: Static Static IP Prefixes: 10.11.0.0/16. Đây là giải địa chỉ IP ở môi trường Onpremise giả lập. Các cấu hình khác giữ nguyên mặc định.  Kéo màn hình xuống dưới cùng và click Create VPN Connection. Click Close sau khi VPN Connection đã được tạo thành công.  Cấu hình propagation cho các route table   Truy cập trang Amazon VPC console tại địa chỉ https://console.aws.amazon.com/vpc/ Tại menu bên trái, click Route Tables. Click chọn route table Route table - Public. Click tab Route Propagation. Click Edit route propagation.  Click vào ô Enable. Click Save để lưu Route table.    Làm tương tự bước 3 cho Route table - Private. Kiểm tra trạng thái Propagation là Yes như hình dưới.   Tiếp theo chúng ta sẽ tiến hành cài đặt và cấu hình Customer Gateway software sử dụng Open Swan.\n  "
},
{
	"uri": "/vi/3-create-vpc/3.3-security-group/",
	"title": "Tạo Security Group",
	"tags": [],
	"description": "",
	"content": "Ở bước này chúng ta sẽ tạo 2 security group cho phép thực hiện ping và ssh để sử dụng cho 2 máy chủ EC2 nằm trong public subnet và private subnet.\nTạo Security Group cho máy chủ nằm trong Public subnet   Truy cập Amazon VPC console.\n  Trên thanh điều hướng bên trái, chọn Security Group, click Create Security Group.   Trong phần Security group name điền Public subnet - SG\n  Trong phần **Description ** điền Allow SSH and Ping for servers in public subnet.\n  Click chọn VPC, lựa chọn VPC có tên ASG.   Trong Inbound rules, click Add rule.\n  Chọn Type: SSH và Source: My IP. My IP đại diện cho 1 địa chỉ public IPv4 bạn đang sử dụng.\n  Click Add rule để thêm 1 rule mới.\n  Chọn Type: Custom ICMP v4 và Source: Anywhere. Cho phép ping từ bất kì địa chỉ IP nào.   Kéo màn hình xuống dưới và Click Create Security Group.\n  Tạo Security Group cho máy chủ nằm trong Private subnet   Truy cập Amazon VPC console.\n  Trên thanh điều hướng bên trái, chọn Security Group, click Create Security Group.   Trong phần Security group name điền Private subnet - SG\n  Trong phần Description điền Allow SSH and Ping for servers in private subnet.\n  Click chọn VPC, lựa chọn VPC có tên ASG.   Trong Inbound rules, click Add rule.\n  Chọn Type: SSH và để nguyên Source: Custom. Click vào search box và chọn Public subnet SG.Lựa chọn này cho phép tất cả những máy chủ được gán Public subnet SG được SSH vào các máy chủ được gán Private subnet SG.   Click Add rule để thêm 1 rule mới.\n  Chọn Type: Custom ICMP v4 và Source: Anywhere. Cho phép ping từ bất kì địa chỉ IP nào.   Kéo màn hình xuống dưới và Click Create Security Group.\n  Như vậy chúng ta đã tạo được 2 Security Group cho các máy chủ nằm trong public subnet và private subnet.\n  Tiếp theo chúng ta sẽ tiến hành tạo 2 máy chủ EC2.\n  "
},
{
	"uri": "/vi/4-vpn-sitetosite/4.2-config-vpn/4.2.4-config-customergw/",
	"title": "Cấu hình Customer GW ",
	"tags": [],
	"description": "",
	"content": " Để tải tập tin cấu hình cho VPN Connection ở phía On-premise. Bạn có thể tải Template từ phía AWS cung cấp:   Truy cập trang Amazon VPC console tại địa chỉ https://console.aws.amazon.com/vpc/ Kéo thanh điều hướng bên trái xuống dưới, click Site-to-Site VPN Connection. Chọn VPN Connection đã tạo, sau đó chọn Download Configuration.   Trong hộp thoại Download Configuration, lựa chọn appliance phù hợp với bạn: Trong bài thực hành này, chúng ta sẽ sử dụng OpenSwan.  Vendor:\tChọn OpenSwan Platform:\tChọn OpenSwan Software:\tChọn OpenSwan 2.6.38+ Click Download.     Lưu thông tin file câu hình vào thư mục chúng ta sử dụng lưu trữ key pair và công cụ cho bài lab.  Sau đó dựa vào cấu hình được cung cấp, bạn thay đổi các thông tin phù hợp và cấu hình cho thiết bị của mình. Kết nối ssh vào EC2 Customer Gateway.    Cài đặt OpenSwan  sudo su yum install openswan -y Kiểm tra cấu hình file /etc/ipsec.conf   Chạy lệnh vi /etc/ipsec.conf Kiểm tra cấu hình đang như hình dưới.  Ấn phím ESC và tổ hợp :q! để thoát khỏi trình chỉnh sửa vi.  Cấu hình file /etc/sysctl.conf   Chạy lệnh vi /etc/sysctl.conf Chuyển xuống vị trí cuối cùng trong file cấu hình. Ấn phím i để tiến hành chỉnh sửa file. Thêm cấu đoạn sau vào cuối tập tin cấu hình.  net.ipv4.ip_forward = 1 net.ipv4.conf.all.accept_redirects = 0 net.ipv4.conf.all.send_redirects = 0  Ấn phím ESC và tổ hợp :wq! để lưu file cấu hình.   Sau đó để áp dụng cấu hình này, chạy lệnh:  sysctl -p Tiếp theo chúng ta sẽ cấu hình file /etc/ipsec.d/aws.conf   Chạy lệnh vi /etc/ipsec.d/aws.conf Ấn phím i để tiến hành chỉnh sửa file. Thêm cấu đoạn sau vào tập tin cấu hình. Chúng ta sẽ tạo 2 Tunnel với thông tin được lấy từ file cấu hình VPN Connection bạn đã tải về và lưu chung vào thư mục chứa key pair trước đó.  conn Tunnel1 authby=secret auto=start left=%defaultroute leftid=13.212.233.95 right=52.220.15.74 type=tunnel ikelifetime=8h keylife=1h phase2alg=aes128-sha1;modp1024 ike=aes128-sha1;modp1024 keyingtries=%forever keyexchange=ike leftsubnet=10.11.0.0/16 rightsubnet=10.10.0.0/16 dpddelay=10 dpdtimeout=30 dpdaction=restart_by_peer conn Tunnel2 authby=secret auto=start left=%defaultroute leftid=13.212.233.95 right=54.255.91.142 type=tunnel ikelifetime=8h keylife=1h phase2alg=aes128-sha1;modp1024 ike=aes128-sha1;modp1024 keyingtries=%forever keyexchange=ike leftsubnet=10.11.0.0/16 rightsubnet=10.10.0.0/16 dpddelay=10 dpdtimeout=30 dpdaction=restart_by_peer  Ấn phím ESC và tổ hợp :wq! để lưu file cấu hình.  \rĐảm bảo bạn chỉnh sửa địa chỉ IP và lớp mạng phù hợp trước khi copy đoạn cấu hình trên nhé. Đối với Amazon Linux thì chúng ta sẽ bỏ dòng auth=esp trong file cấu hình gốc. leftid: IP Public Address phía Onprem. ( Ở đây chính là IP public của EC2 Customer Gateway trong ASG VPN VPC) right: IP Public Address phía AWS VPN Tunnel. leftsubnet: CIDR của Mạng phía Local (Nếu có nhiều lớp mạng, bạn có thể để là 0.0.0.0/0). rightsubnet: CIDR của Mạng phía Private Subnet trên AWS.\n\r Kiểm tra bước tiếp theo trong file cấu hình chúng ta đã tải xuống.   Tạo mới và cấu hình file etc/ipsec.d/aws.secrets Tạo tập tin mới với cấu hình sau để thiết lập chứng thực cho 2 Tunnel.\n   Chạy lệnh touch /etc/ipsec.d/aws.secrets để tạo tập tin. Chạy lệnh vi /etc/ipsec.d/aws.secrets Ấn phím i để tiến hành chỉnh sửa file. Thêm cấu đoạn sau vào cuối tập tin cấu hình.  13.212.233.95 52.220.15.74: PSK \u0026#34;2ned6kIANuA8nPtYnwvQVwak_fJcmSP5\u0026#34; 13.212.233.95 54.255.91.142: PSK \u0026#34;jdkPQG140TeUacw3rnKlyavxnrNaAkZ7\u0026#34;  Ấn phím ESC và tổ hợp :wq! để lưu file cấu hình. Chạy lệnh cat /etc/ipsec.d/aws.secrets để kiểm tra nội dung file cấu hình.   Khởi động lại Network service \u0026amp; IPSEC service  service network restart chkconfig ipsec on service ipsec start service ipsec status "
},
{
	"uri": "/vi/4-vpn-sitetosite/4.3-testing/",
	"title": "Kiểm tra Hoạt động",
	"tags": [],
	"description": "",
	"content": "Test ping từ Private EC2 tới Private Server Onprem Hãy thử thực hiện lệnh ping từ phía máy chủ trên AWS xuống máy chủ ở phía On-premise của bạn. Sau khi thiết lập đường VPN thì chúng đã có thể thấy được nhau.\n"
},
{
	"uri": "/vi/3-create-vpc/3.4-create-ec2/",
	"title": "Tạo máy chủ EC2",
	"tags": [],
	"description": "",
	"content": "Ở bước này chúng ta sẽ tạo 2 máy chủ EC2 ( EC2 instance ) như kiến trúc dưới đây.\nTạo EC2 nằm trong Public subnet   Truy cập Amazon EC2 console tại địa chỉ https://console.aws.amazon.com/ec2/.\n  Trên thanh điều hướng bên trái, chọn Intances, Launch Intance.   Chọn Select để chọn Amazon Machine Image (AMI) Amazon Linux 2 AMI (HVM), SSD Volume Type.   Giữ nguyên lựa chọn General purpose t2.micro, sau đó click Next: Configure Instance Details.   Tại trang Configure Instance Details\n   Network chọn VPC ASG. Subnet chọn subnet Public subnet 1. Auto-assign Public IP kiểm tra xem có đang Enable hay không. Nếu không Enable, bạn cần kiểm tra lại phần cấu hình tự động cấp phát public IP cho subnet tại mục 3.1. Sau đó click Next: Add Storage.   Tại trang Add Storage. Giữ nguyên cấu hình mặc định và Click Next: Add Tags Tại trang Add Tags, Chọn Add Tag   Key điền Name. Value điền EC2 Public. Sau đó bấm Next: Configure Security Group.   Tại trang Configure Security Group   Assign a security group click chọn Select an existing security group. Name chọn security group cho các EC2 trong public cubnet có tên Public subnet -SG. Sau đó bấm Review và Launch.   Kiểm tra lại thông tin cấu hình và Click Launch.   Một prompt Choose an existing key pair or Create new key pair xuất hiện. Chọn Create a new key pair. Key pair name: asg-keypair. Click Download Key Pair. Chọn đường dẫn để lưu file key pair. Bạn sẽ cần file key pair để có thể kết nối ssh tới EC2 Public instance bạn sắp tạo. Click Save để lưu file key pair. Click Launch.  Click View Instances và chờ cho tới khi EC2 khởi tạo xong.  Tạo EC2 nằm trong Private subnet  Truy cập Amazon EC2 console tại địa chỉ https://console.aws.amazon.com/ec2/. Trên thanh điều hướng bên trái, chọn Intances, Launch Intance. Chọn Select để chọn Amazon Machine Image (AMI) Amazon Linux 2 AMI (HVM), SSD Volume Type.  Giữ nguyên lựa chọn General purpose t2.micro, sau đó click Next: Configure Instance Details.  Tại trang Configure Instance Details   Network chọn VPC ASG. Subnet chọn subnet Private subnet 2. Auto-assign Public IP kiểm tra xem có đang Disable hay không. Nếu không Disable, bạn cần kiểm tra lại phần cấu hình tự động cấp phát public IP cho subnet tại mục 3.1. Sau đó click Next: Add Storage.   Tại trang Add Storage. Giữ nguyên cấu hình mặc định và Click Next: Add Tags Tại trang Add Tags, Chọn Add Tag   Key điền Name. Value điền EC2 Private. Sau đó bấm Next: Configure Security Group.   Tại trang Configure Security Group   Assign a security group click chọn Select an existing security group. Name chọn security group cho các EC2 trong public cubnet có tên Private subnet -SG. Sau đó bấm Review và Launch.   Kiểm tra lại thông tin cấu hình và Click Launch.   Một prompt Choose an existing key pair or Create new key pair xuất hiện. Chọn Choose an existing keypairr. Chọn Key pair name: asg-keypair. Click I acknowledge that I have access to the selected private key file (asg-keypair.pem), and that without this file, I won\u0026rsquo;t be able to log into my instance. để xác nhận rằng mình có thể truy cập tới Key pair bạn đã chọn. Click Launch.  Click View Instances và chờ cho tới khi EC2 khởi tạo xong.  Như vậy chúng ta đã tạo được 2 máy chủ EC2 theo mô hình kiến trúc bên dưới. Bước tiếp theo chúng ta sẽ thử truy cập vào 2 máy chủ này.  "
},
{
	"uri": "/vi/4-vpn-sitetosite/",
	"title": "Cấu hình Site-to-Site VPN",
	"tags": [],
	"description": "",
	"content": "Mặc định từ bên ngoài có thể kết nối TTDL On-premise tới Amazon VPC sử dụng VPN cứng hoặc mềm tùy thuộc mục đích và nhu cầu sử dụng thực thế.\nĐể thiết lập kết nối VPN Site to Site. Chúng ta sẽ cần tạo và cấu hình Virtual Private Gateway VPG và Customer Gateway CGW.\n Virtual Private Gateway (VPG) là một trung tâm điều khiển kết nối the virtual private network (VPN) được cài đặt ở đầu AWS. A Customer Gateway (CGW) là thành phần đại diện cho thiết bị VPN cứng hoặc mềm được cài đặt ở đầu Khách hàng.  VPN tunnel sẽ được thiết lập ngay sau khi lưu lượng dữ liệu được truyền tải giữa AWS và hệ thống mạng của khách hàng. Trong kết nối đó, ta phải chỉ rõ loại định tuyến sẽ được sử dụng để đảm bảo an toàn cũng như chất lượng về mặt truyền tải dữ liệu.\nNếu CGW ở phía khách hàng có hỗ trợ Border Gateway Protocol (BGP), thì trong cấu hình VPN connection ta bắt buộc phải đặt định tuyến là dynamic routing.\nCòn ngược lại ta phải cấu hình định tuyến kết nối là static routing. Trường hợp sử dụng static routing, ta phải nhập chính xác những định tuyến cần thiết cho việc kết nối từ phía Khách hàng tới VPG được thiết lập ở đầu AWS. Đồng thời định tuyến cho VPC cũng phải được cấu hình propagated để cho phép các tài nguyên có thể trao đổi dữ liệu đi ra và đi vào trong kết nối VPN tunnel giữa AWS với hệ thống mạng của Khách hàng\nAmazon VPC cung cấp nhiều loại CGWs, và từng CGW được gán với một VPG nhưng 1 VPG có thể kết hợp với nhiều CGW (many-to-one design). Để hỗ trợ mô hình này thì địa chỉ IP của CGW phải là duy nhất trong một region.\nAmazon VPC cũng cung cấp các thông tin cần thiết cho Nhân viên quản trị mnagj có thể cấu hình CGW và thiết lập kết nối VPN tới VPG trên AWS. Kết nối VPN luôn bao gồm 2 Internet Protocol Security (IPSec) tunnels để đảm bảo tính sẵn sàng cao của kết nối.\nBên dưới là những đặc điểm quan trọng mà ta cần nắm về VPG, CGW, and VPN:\n VPG là thành phần đầu cuối của VPN tunnel nằm trên AWS. CGW có thể là thiết bị phần cứng hoặc ứng dụng phần mềm nằm ở đầu Khách hàng trong kết nối VPN tunnel. Bạn phải khởi tạo kết nối VPN tunnel từ CGW tới VPG. VPG hỗ trợ cả dynamic routing (BGP) và static routing. Kết nối VPN luôn có 2 tunnels nhằm đảm bảo tính sẵn sàng cao cho kết nối với VPC từ site Khách hàng.  Bài lab giúp chúng ta học được cách thiết lập một kết nối Site to Site VPN trong AWS. Trong thực tế, giải pháp này khá được ưa chuộng do ưu điểm giá thành rẻ, đồng thời rất dễ cấu hình do AWS cung cấp hướng dẫn cho từng loại thiết bị phía đầu Customer. Việc Cust bận tâm duy nhất đó là chuẩn bị đường internet để từ đó tạo đường hầm an toàn bí mật (sử dụng ipsec) kết nối tới AWS thông qua AWS VPN tunnel.\nTrong phạm vi bài lab, giả lập rằng chúng ta có Main office ( VPC ASG ) và Branch office ( VPC ASG VPN ) đặt tại 2 VPC thuộc 2 AZ khác nhau để có sự khác biệt về mặt network. Trên mỗi VPC thực hiện tạo 2 EC2 cho phép SSH từ bên ngoài, nhưng không có khả năng kết nối và ping lẫn nhau sử dụng địa chỉ Private IP của mỗi EC2. Việc ta cần làm là cấu hình VPN để các địa chỉ Private IP có thể ping được lẫn nhau sử dụng VPN Site-to-Site.\nNội dung:\n Tạo ASG VPN VPC và subnet Cấu hình Site to Site VPN  Kiểm tra kết nối từ giữa 2 private instance  "
},
{
	"uri": "/vi/3-create-vpc/3.5-test-connect/",
	"title": "Kiểm tra kết nối",
	"tags": [],
	"description": "",
	"content": "Ở bước này chúng ta sẽ kết nối ssh tới 2 máy chủ EC2 ( EC2 instance ) chúng ta đã tạo ở bước 3.4. Sau đó thực hiện ping test để kiểm tra khả năng kết nối internet.\nKết nối vào máy chủ EC2 Public và kiểm tra truy cập Internet.   Truy cập Amazon EC2 console tại địa chỉ https://console.aws.amazon.com/ec2/.\n  Kiểm tra và lấy thông tin public IP của máy chủ EC2 Public.   Download putty và puttygen để kết nối ssh tới EC2 Public.\n   \r\r\rPutty and Puttygen\r\r\rpscp.exe\r\r(717 ko)\r\r\rputty.exe\r\r(1244 ko)\r\r\rputtygen.exe\r\r(784 ko)\r\r\r\r  Trước tiên mở puttygen bạn đã download về để thực hiện convert asg-keypair.pem sang asg-keypair.ppk.   Click Load. Chuyển thư mục tới đường dẫn mà bạn đã download asg-keypair.pem. Chọn hiển thị All Files. Chọn asg-keypair.pem. Click Open.  Click Ok. Click Save Private Key. Click Yes. Điền tên asg-keypair. Click Save.   Mở công cụ putty mà bạn đã tải về, điền thông tin public IP vào mục Host name.   Điền EC Public vào mục Saved sessions. Click Save.   Tiếp theo chúng ta sẽ sử dụng key pair để có thể kết nối tới EC2 public.   Click SSH. Click Auth. Click Browse. Chuyển đường dẫn thư mục tới thư mục chứa file asg-keypair.ppk. Chuyển định dạng file sang *.ppk. Chọn file asg-keypair.ppk. Click Open. Click Open để thực hiện kết nối tới EC2 Public.   Nhập ec2-user. ec2-user là user mặc định của Amazon Linux AMI.   Gõ lệnh ping amazon.com để kiểm tra kết nối tới internet của EC2 Public.  ping amazon.com Kết nối vào máy chủ EC2 Private và kiểm tra kết nối internet.  Truy cập Amazon EC2 console. Kiểm tra và lấy thông tin private IP của máy chủ EC2 Private.   Thực hiện lệnh ping \u0026lt;địa chỉ IP private của EC2 Private\u0026gt; để kiểm tra kết nối từ máy chủ EC2 Public sang máy chủ EC2 Private.   EC2 Private sẽ không có public IP address vì chúng ta không gán cho máy chủ này public IP. Để có thể ssh vào EC2 Private, chúng ta sẽ thực hiện kết nối ssh từ EC2 Public thông qua địa chỉ private IP address của EC2 Private    Download công cụ pscp vào cùng thư mục chứa file asg-keypair.ppk để thực hiện copy file *asg-keypair.pem từ máy của chúng ta vào EC2 Public.\n \r\r\rpscp tool\r\r\rpscp.exe\r\r(717 ko)\r\r\r\r    Khởi chạy Command Prompt.Chuyển đường dẫn tới thư mục bạn vừa download pscsp. Chạy lệnh dưới đây để upload file asg-keypair.pem lên thư mục /home/ec2-user/ của máy chủ EC2 Public.\n  Bạn sẽ cần thay thế thông số public IP address của EC2 Public trước khi chạy câu lệnh.\n  pscp -i asg-keypair.ppk asg-keypair.pem ec2-user@\u0026lt;EC2 PUBLIC public IP address\u0026gt;:/home/ec2-user/ Đảm bảo bạn copy file asg-keypair.pem lên máy chủ EC2 Public.\n\rCập nhật quyền cho file asg-keypair.pem bằng cách chạy lệnh chmod 400 asg-keypair.pem. AWS yêu cầu file key pair cần được hạn chế quyền truy cập trước khi được sử dụng để kết nối tới máy chủ EC2.  chmod 400 asg-keypair.pem ssh tới máy chủ EC2 Private và thực hiện ping test tới amazon.com.  ssh -i asg-keypair.pem ec2-user@\u0026lt;EC2 Private server's private IP address\u0026gt; ping amazon.com 6. Bạn có thể thấy, chúng ta không thể kết nối internet từ EC2 Private. Trong bước tiếp theo chúng ta sẽ tạo NAT Gateway để cho phép máy chủ EC2 Private kết nối internet theo chiều từ nội bộ đi ra. Giữ nguyên kết nối tới EC2 Private để chúng ta có thể kiểm tra kết nối tới internet sau khi hoàn tất tạo và cáu hình NAT Gateway nhé.\n"
},
{
	"uri": "/vi/3-create-vpc/3.6-nat-gateway/",
	"title": "NAT GW",
	"tags": [],
	"description": "",
	"content": "Ở bước này chúng ta sẽ tạo NAT Gateway để cho phép máy chủ EC2 Private có thể ra ngoài internet theo mô hình dưới đây.\nTạo một địa chỉ Elastic IP  Truy cập Amazon VPC console. Trên thanh điều hướng bên trái, chọn Elastic IPs. Click Allocate Elastic IP address .  Click Allocate. Chúng ta vừa tạo thành công một địa chỉ Public IP Address: 54.251.117.148   Tạo một NAT Gateway  Truy cập Amazon VPC console. Trên thanh điều hướng bên trái, chọn NAT Gateways. Chọn Create NAT Gateway.  Tại trang Create NAT Gateway:   Mục Name điền NAT Gateway. Mục subnet chọn Public subnet 2. Mục Elastic IP Allocation ID chọn Elastic IP address chúng ta vừa tạo. Click Create NAT Gateway   Tạo Route table - Private và gáng vào các private subnet.  Truy cập Amazon VPC console. Trên thanh điều hướng bên trái, chọn Route Tables. Click Create route table  Tại trang Create route table:   Mục Name tag điền Route table - Private.  Mục VPC chọn VPC ASG. Click Create    Sau khi tạo route table thành công, click Close.  Chọn Route table - Private.   Click tab Subnet Associations. Click Edit subnet associations.  Chọn 2 private subnet và click Save.  Chọn Route table - Private.    Click tab Route.\n  Click Edit route.   Chọn Add Route\n  Destination: 0.0.0.0/0\n  Target: NAT Gateway\n  Chọn Save routes   Click Close sau khi thêm route entry thành công.\n   Kiểm tra ping amazon.com thành công từ EC2 Private.   Chúc mừng các bạn, như vậy chúng ta đã hoàn thành mô hình lab như bên dưới. Trong phần kế tiếp chúng ta sẽ cùng khởi tạo và cấu hình kết nối VPN Site to Site để kết nối môi trường onpremise lên AWS Cloud nhé.   "
},
{
	"uri": "/vi/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/vi/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]